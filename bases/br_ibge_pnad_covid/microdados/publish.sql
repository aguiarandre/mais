/*

Query para publicar a tabela.

Esse é o lugar para:
    - modificar nomes, ordem e tipos de colunas
    - dar join com outras tabelas
    - criar colunas extras (e.g. logs, proporções, etc.)

Qualquer coluna definida aqui deve também existir em `table_config.yaml`.

# Além disso, sinta-se à vontade para alterar alguns nomes obscuros
# para algo um pouco mais explícito.

TIPOS:
    - Para modificar tipos de colunas, basta substituir STRING por outro tipo válido.
    - Exemplo: `SAFE_CAST(column_name AS NUMERIC) column_name`
    - Mais detalhes: https://cloud.google.com/bigquery/docs/reference/standard-sql/data-types

*/
SELECT 
SAFE_CAST(ano AS INT64) ano,
SAFE_CAST(mes AS INT64) mes,
SAFE_CAST(semana AS INT64) semana,
SAFE_CAST(estado_abrev AS STRING) estado_abrev,
SAFE_CAST(capital AS INT64) capital,
SAFE_CAST(rm_ride AS INT64) rm_ride,
SAFE_CAST(estrato AS INT64) estrato,
SAFE_CAST(UPA AS INT64) UPA,
SAFE_CAST(numero_domicilio AS INT64) numero_domicilio,
SAFE_CAST(numero_entrevista AS INT64) numero_entrevista,
SAFE_CAST(ordem AS INT64) ordem,
SAFE_CAST(situacao AS INT64) situacao,
SAFE_CAST(tipo_area AS INT64) tipo_area,
SAFE_CAST(projecao_pop AS INT64) projecao_pop,
SAFE_CAST(peso_pre_estrat AS NUMERIC) peso_pre_estrat,
SAFE_CAST(peso_pos_estrat AS NUMERIC) peso_pos_estrat,
SAFE_CAST(posest AS INT64) posest,
SAFE_CAST(A001A AS INT64) A001A,
SAFE_CAST(A001B1 AS INT64) A001B1,
SAFE_CAST(A001B2 AS INT64) A001B2,
SAFE_CAST(A001B3 AS INT64) A001B3,
SAFE_CAST(A002 AS INT64) A002,
SAFE_CAST(A003 AS INT64) A003,
SAFE_CAST(A004 AS INT64) A004,
SAFE_CAST(A005 AS INT64) A005,
SAFE_CAST(A006 AS INT64) A006,
SAFE_CAST(A007 AS INT64) A007,
SAFE_CAST(A008 AS INT64) A008,
SAFE_CAST(A009 AS INT64) A009,
SAFE_CAST(B0011 AS INT64) B0011,
SAFE_CAST(B0012 AS INT64) B0012,
SAFE_CAST(B0013 AS INT64) B0013,
SAFE_CAST(B0014 AS INT64) B0014,
SAFE_CAST(B0015 AS INT64) B0015,
SAFE_CAST(B0016 AS INT64) B0016,
SAFE_CAST(B0017 AS INT64) B0017,
SAFE_CAST(B0018 AS INT64) B0018,
SAFE_CAST(B0019 AS INT64) B0019,
SAFE_CAST(B00110 AS INT64) B00110,
SAFE_CAST(B00111 AS INT64) B00111,
SAFE_CAST(B00112 AS INT64) B00112,
SAFE_CAST(B00113 AS INT64) B00113,
SAFE_CAST(B002 AS INT64) B002,
SAFE_CAST(B0031 AS INT64) B0031,
SAFE_CAST(B0032 AS INT64) B0032,
SAFE_CAST(B0033 AS INT64) B0033,
SAFE_CAST(B0034 AS INT64) B0034,
SAFE_CAST(B0035 AS INT64) B0035,
SAFE_CAST(B0036 AS INT64) B0036,
SAFE_CAST(B0037 AS INT64) B0037,
SAFE_CAST(B0041 AS INT64) B0041,
SAFE_CAST(B0042 AS INT64) B0042,
SAFE_CAST(B0043 AS INT64) B0043,
SAFE_CAST(B0044 AS INT64) B0044,
SAFE_CAST(B0045 AS INT64) B0045,
SAFE_CAST(B0046 AS INT64) B0046,
SAFE_CAST(B005 AS INT64) B005,
SAFE_CAST(B006 AS INT64) B006,
SAFE_CAST(B007 AS INT64) B007,
SAFE_CAST(B008 AS INT64) B008,
SAFE_CAST(B009A AS INT64) B009A,
SAFE_CAST(B009B AS INT64) B009B,
SAFE_CAST(B009C AS INT64) B009C,
SAFE_CAST(B009D AS INT64) B009D,
SAFE_CAST(B009E AS INT64) B009E,
SAFE_CAST(B009F AS INT64) B009F,
SAFE_CAST(B0101 AS INT64) B0101,
SAFE_CAST(B0102 AS INT64) B0102,
SAFE_CAST(B0103 AS INT64) B0103,
SAFE_CAST(B0104 AS INT64) B0104,
SAFE_CAST(B0105 AS INT64) B0105,
SAFE_CAST(B0106 AS INT64) B0106,
SAFE_CAST(B011 AS INT64) B011,
SAFE_CAST(C001 AS INT64) C001,
SAFE_CAST(C002 AS INT64) C002,
SAFE_CAST(C003 AS INT64) C003,
SAFE_CAST(C004 AS INT64) C004,
SAFE_CAST(C005 AS INT64) C005,
SAFE_CAST(C0051 AS INT64) C0051,
SAFE_CAST(C0052 AS INT64) C0052,
SAFE_CAST(C0053 AS INT64) C0053,
SAFE_CAST(C006 AS INT64) C006,
SAFE_CAST(C007 AS INT64) C007,
SAFE_CAST(C007A AS INT64) C007A,
SAFE_CAST(C007B AS INT64) C007B,
SAFE_CAST(C007C AS INT64) C007C,
SAFE_CAST(C007D AS INT64) C007D,
SAFE_CAST(C007E AS INT64) C007E,
SAFE_CAST(C007E1 AS INT64) C007E1,
SAFE_CAST(C007E2 AS INT64) C007E2,
SAFE_CAST(C007F AS INT64) C007F,
SAFE_CAST(C008 AS INT64) C008,
SAFE_CAST(C009 AS INT64) C009,
SAFE_CAST(C009A AS INT64) C009A,
SAFE_CAST(C010 AS INT64) C010,
SAFE_CAST(C0101 AS INT64) C0101,
SAFE_CAST(C01011 AS INT64) C01011,
SAFE_CAST(C01012 AS INT64) C01012,
SAFE_CAST(C0102 AS INT64) C0102,
SAFE_CAST(C01021 AS INT64) C01021,
SAFE_CAST(C01022 AS INT64) C01022,
SAFE_CAST(C0103 AS INT64) C0103,
SAFE_CAST(C0104 AS INT64) C0104,
SAFE_CAST(C011A AS INT64) C011A,
SAFE_CAST(C011A1 AS INT64) C011A1,
SAFE_CAST(C011A11 AS INT64) C011A11,
SAFE_CAST(C011A12 AS INT64) C011A12,
SAFE_CAST(C011A2 AS INT64) C011A2,
SAFE_CAST(C011A21 AS INT64) C011A21,
SAFE_CAST(C011A22 AS INT64) C011A22,
SAFE_CAST(C012 AS INT64) C012,
SAFE_CAST(C013 AS INT64) C013,
SAFE_CAST(C014 AS INT64) C014,
SAFE_CAST(C015 AS INT64) C015,
SAFE_CAST(C016 AS INT64) C016,
SAFE_CAST(C017A AS INT64) C017A,
SAFE_CAST(D0011 AS INT64) D0011,
SAFE_CAST(D0013 AS INT64) D0013,
SAFE_CAST(D0021 AS INT64) D0021,
SAFE_CAST(D0023 AS INT64) D0023,
SAFE_CAST(D0031 AS INT64) D0031,
SAFE_CAST(D0033 AS INT64) D0033,
SAFE_CAST(D0041 AS INT64) D0041,
SAFE_CAST(D0043 AS INT64) D0043,
SAFE_CAST(D0051 AS INT64) D0051,
SAFE_CAST(D0053 AS INT64) D0053,
SAFE_CAST(D0061 AS INT64) D0061,
SAFE_CAST(D0063 AS INT64) D0063,
SAFE_CAST(D0071 AS INT64) D0071,
SAFE_CAST(D0073 AS INT64) D0073,
SAFE_CAST(E001 AS INT64) E001,
SAFE_CAST(E0021 AS INT64) E0021,
SAFE_CAST(E0022 AS INT64) E0022,
SAFE_CAST(E0023 AS INT64) E0023,
SAFE_CAST(E0024 AS INT64) E0024,
SAFE_CAST(F001 AS INT64) F001,
SAFE_CAST(F0021 AS NUMERIC) F0021,
SAFE_CAST(F0022 AS INT64) F0022,
SAFE_CAST(F006 AS INT64) F006,
SAFE_CAST(F0061 AS INT64) F0061,
SAFE_CAST(F002A1 AS INT64) F002A1,
SAFE_CAST(F002A2 AS INT64) F002A2,
SAFE_CAST(F002A3 AS INT64) F002A3,
SAFE_CAST(F002A4 AS INT64) F002A4,
SAFE_CAST(F002A5 AS INT64) F002A5
from basedosdados-staging.br_ibge_pnad_covid_staging.microdados as t